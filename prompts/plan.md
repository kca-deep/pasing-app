# ë¬¸ì„œ íŒŒì‹± ì‹œìŠ¤í…œ ë¦¬íŒ©í† ë§ í”Œëœ

> **ì‘ì„±ì¼**: 2025-11-05
> **í˜„ì¬ ìƒíƒœ**: Phase 1 ì§„í–‰ ì¤‘ (ì¼ë¶€ ì™„ë£Œ)
> **ëª©í‘œ**: ê¸°ì¡´ ë¡œì§ ì˜í–¥ ì—†ì´ ì•ˆì „í•˜ê²Œ ì½”ë“œ í’ˆì§ˆ ê°œì„ 

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [í˜„ì¬ ì§„í–‰ ìƒí™©](#í˜„ì¬-ì§„í–‰-ìƒí™©)
3. [Phase 1: ê¸´ê¸‰ ê°œì„ ](#phase-1-ê¸´ê¸‰-ê°œì„ -1-2ì£¼)
4. [Phase 2: ì•„í‚¤í…ì²˜ ê°œì„ ](#phase-2-ì•„í‚¤í…ì²˜-ê°œì„ -2-4ì£¼)
5. [Phase 3: ìµœì í™” ë° ì •ë¦¬](#phase-3-ìµœì í™”-ë°-ì •ë¦¬-4-6ì£¼)
6. [ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸](#ê²€ì¦-ì²´í¬ë¦¬ìŠ¤íŠ¸)
7. [ì„±ê³µ ì§€í‘œ](#ì„±ê³µ-ì§€í‘œ)

---

## ê°œìš”

### ğŸ¯ ë¦¬íŒ©í† ë§ ëª©ì 

- **ê°€ë…ì„± í–¥ìƒ**: 500+ ë¼ì¸ God Function ì œê±°
- **ìœ ì§€ë³´ìˆ˜ì„± ê°œì„ **: ì¤‘ë³µ ì½”ë“œ ì œê±°
- **í™•ì¥ì„± í™•ë³´**: Strategy Patternìœ¼ë¡œ ìƒˆ íŒŒì„œ ì¶”ê°€ ìš©ì´
- **ì•ˆì •ì„± ê°•í™”**: íƒ€ì… ì•ˆì •ì„± ë° ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™”

### ğŸ“Š ì „ì²´ ìŠ¤ì½”í”„

**ë¶„ì„ ëŒ€ìƒ**: ì£¼ìš” íŒŒì¼ 6ê°œ
- `backend/app/api/parsing.py` (502 lines) âš ï¸ ìµœìš°ì„ 
- `backend/app/services/docling.py` (291 lines)
- `backend/app/services/dolphin_remote.py` (334 lines)
- `backend/app/services/remote_ocr_parser.py` (283 lines)
- `backend/app/services/mineru_parser.py` (256 lines)
- `backend/app/table_utils.py` (490 lines)

### â±ï¸ ì˜ˆìƒ ê¸°ê°„

- **Phase 1**: 1-2ì£¼ (ì§„í–‰ ì¤‘)
- **Phase 2**: 2-4ì£¼ (Phase 1 ì™„ë£Œ í›„)
- **Phase 3**: 4-6ì£¼ (Phase 2 ì™„ë£Œ + ê²€ì¦ í›„)
- **ì´ ê¸°ê°„**: 7-12ì£¼

### âš ï¸ í•µì‹¬ ì›ì¹™

1. **íŒŒì¼ ì¶”ê°€ ìš°ì„ , ìˆ˜ì • ìµœì†Œí™”**
2. **Feature Flag íŒ¨í„´** (ì–¸ì œë“  ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ ì „í™˜)
3. **ë‹¨ê³„ë³„ ë§ˆì´ê·¸ë ˆì´ì…˜** (ì¶©ë¶„í•œ ê²€ì¦ í›„ ë‹¤ìŒ ë‹¨ê³„)
4. **API/DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì—†ìŒ**

---

## í˜„ì¬ ì§„í–‰ ìƒí™©

### âœ… Phase 1 ì™„ë£Œ (2025-11-05)

**Task 1.1: locals() ì•ˆí‹°íŒ¨í„´ ì œê±°**
- [x] ëª¨ë“  ë³€ìˆ˜ ëª…ì‹œì  ì´ˆê¸°í™” (parsing.py:50-60)
- [x] íƒ€ì… íŒíŠ¸ ì¶”ê°€
- [x] locals() ì²´í¬ ì½”ë“œ ì œê±°

**Task 1.2: ì¤‘ë³µ ì½”ë“œ ì¶”ì¶œ**
- [x] `file_utils.py` ìƒì„± ë° êµ¬í˜„
  - `create_document_output_dir()` - ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
  - `OutputStructure` í´ë˜ìŠ¤ - ì¶œë ¥ êµ¬ì¡° í‘œì¤€í™”
  - `build_output_structure()` - ì¶œë ¥ êµ¬ì¡° ë¹Œë”
  - `save_parsing_output()` - ê²°ê³¼ ì €ì¥
- [x] `parsing.py`ì— í—¬í¼ í•¨ìˆ˜ ì ìš©
  - Remote OCR, MinerU, Docling ì„¹ì…˜ì— ì ìš©
  - ì¤‘ë³µ ì½”ë“œ ì œê±° ì™„ë£Œ

**Task 1.3: ë³€ìˆ˜ëª… ê°œì„  ë° ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°**
- [x] ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” import ì œê±°
  - `os`, `OutputStructure`, `save_parsing_output` ë“± ì œê±°
- [x] `doc_name` ë²„ê·¸ ìˆ˜ì • (ì •ì˜ë˜ì§€ ì•Šì€ ë³€ìˆ˜)
- [x] Import ì •ë ¬ (isort)
- [x] ì½”ë“œ í¬ë§·íŒ… (black)
- [x] Flake8 ë¦°í„° í†µê³¼

**Phase 1 ê²€ì¦**
- [x] API ì •ìƒ ì„í¬íŠ¸ í™•ì¸
- [x] ì„œë²„ ê¸°ë™ í…ŒìŠ¤íŠ¸
- [x] Flake8 ë¦°í„° í†µê³¼
- [ ] Mypy íƒ€ì… ê²€ì‚¬ (ì‹¤í–‰ ì¤‘)

### ğŸ”„ ì§„í–‰ ì¤‘ì¸ ì‘ì—…

- Phase 1 ì™„ë£Œ ê²€ì¦ ë° ë¬¸ì„œí™”

### ğŸ“ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…

- Phase 2: Strategy Pattern ë„ì…
- Phase 3: ìµœì í™” ë° ì •ë¦¬

---

## Phase 1: ê¸´ê¸‰ ê°œì„  (1-2ì£¼)

> **ëª©í‘œ**: ì¦‰ê°ì ì¸ ì½”ë“œ í’ˆì§ˆ ê°œì„  (ë¦¬ìŠ¤í¬ ìµœì†Œ)
> **ì˜í–¥ ë²”ìœ„**: `parsing.py` íŒŒì¼ + ìƒˆ íŒŒì¼ ì¶”ê°€
> **ë¡¤ë°±**: Git revertë¡œ ì¦‰ì‹œ ê°€ëŠ¥

### âœ… Task 1.1: locals() ì•ˆí‹°íŒ¨í„´ ì œê±° (ì™„ë£Œ)

**ìƒíƒœ**: âœ… ì™„ë£Œ

#### ì™„ë£Œëœ ì‘ì—…

- [x] **1.1.1** ëª¨ë“  ë³€ìˆ˜ ëª…ì‹œì  ì´ˆê¸°í™” (`parsing.py:55-66`)
- [x] **1.1.2** locals() ì²´í¬ ì½”ë“œ ì œê±°
- [x] **1.1.3** íƒ€ì… íŒíŠ¸ ì¶”ê°€

#### ê²€ì¦ í•„ìš”

- [ ] **1.1.T1** ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ëª¨ë‘ í†µê³¼ í™•ì¸
- [ ] **1.1.T2** mypy íƒ€ì… ê²€ì‚¬ í†µê³¼ í™•ì¸
  ```bash
  mypy backend/app/api/parsing.py
  ```
- [ ] **1.1.T3** ëª¨ë“  íŒŒì‹± ì „ëµ ìˆ˜ë™ í…ŒìŠ¤íŠ¸
  - [ ] Remote OCR (í•œê¸€ ë¬¸ì„œ)
  - [ ] MinerU
  - [ ] Docling + Camelot

---

### âœ… Task 1.2: ì¤‘ë³µ ì½”ë“œ ì¶”ì¶œ (ì™„ë£Œ)

**ìƒíƒœ**: âœ… ì™„ë£Œ

#### ì™„ë£Œëœ ì‘ì—…

- [x] **1.2.1** `file_utils.py` ìƒì„± ë° êµ¬í˜„
  - `create_document_output_dir()` - ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
  - `OutputStructure` í´ë˜ìŠ¤ - ì¶œë ¥ êµ¬ì¡° í‘œì¤€í™”
  - `build_output_structure()` - ì¶œë ¥ êµ¬ì¡° ë¹Œë”
  - `save_parsing_output()` - ê²°ê³¼ ì €ì¥

- [x] **1.2.2** `parsing.py`ì— í—¬í¼ í•¨ìˆ˜ ì ìš©
  - Remote OCR ì„¹ì…˜ (line 89)
  - MinerU ì„¹ì…˜ (line 153)
  - ì¶œë ¥ êµ¬ì¡° ìƒì„± ë¶€ë¶„ (line 126, 193)

#### ê²€ì¦ í•„ìš”

- [ ] **1.2.T1** `file_utils.py` ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± ë° ì‹¤í–‰
  ```bash
  pytest backend/tests/test_file_utils.py -v --cov=app.utils.file_utils
  ```
- [ ] **1.2.T2** í†µí•© í…ŒìŠ¤íŠ¸: ëª¨ë“  ì „ëµ ì •ìƒ ë™ì‘
  - [ ] Remote OCR â†’ ì¶œë ¥ ë””ë ‰í† ë¦¬ í™•ì¸
  - [ ] MinerU â†’ ì¶œë ¥ ë””ë ‰í† ë¦¬ + images í™•ì¸
  - [ ] Docling â†’ ì¶œë ¥ ë””ë ‰í† ë¦¬ + tables í™•ì¸
- [ ] **1.2.T3** ì¶œë ¥ ë””ë ‰í† ë¦¬ êµ¬ì¡° ë³€í™” ì—†ìŒ í™•ì¸

---

### ğŸ”„ Task 1.3: ë³€ìˆ˜ëª… ê°œì„  ë° ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°

**ìƒíƒœ**: ğŸ”„ ì§„í–‰ ì¤‘

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

##### 1.3.1 ë³€ìˆ˜ëª… ê°œì„ 

- [ ] **1.3.1.1** `will_use_camelot` ì´ˆê¸°í™” ìœ„ì¹˜ ê²€í† 
  - í˜„ì¬: line 65 (í•¨ìˆ˜ ì‹œì‘)ì—ì„œ ì´ˆê¸°í™”
  - line 217ì—ì„œ ì‹¤ì œ ê°’ ì„¤ì •
  - âœ… í˜„ì¬ êµ¬ì¡°ê°€ ëª…ì‹œì  ì´ˆê¸°í™”ë¡œ ì ì ˆí•¨

- [ ] **1.3.1.2** ë³€ìˆ˜ëª… ëª…í™•ì„± ê²€í† 
  - `strategy`: íŒŒì‹± ì „ëµ ì´ë¦„ (ì ì ˆí•¨)
  - `table_summary`: íŒŒì‹± ê²°ê³¼ ìš”ì•½ (ì ì ˆí•¨)
  - `parsing_metadata`: íŒŒì‹± ë©”íƒ€ë°ì´í„° (ì ì ˆí•¨)

##### 1.3.2 ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ ì œê±°

- [ ] **1.3.2.1** ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” import ê²€ì‚¬
  ```bash
  autoflake --check --remove-all-unused-imports backend/app/api/parsing.py
  ```

- [ ] **1.3.2.2** ë¶ˆí•„ìš”í•œ ì¬í• ë‹¹ ê²€í† 
  - parsing.py ì „ì²´ ìŠ¤ìº” í•„ìš”
  - ì¬í• ë‹¹ í›„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ ì°¾ê¸°

- [ ] **1.3.2.3** Dead code ì œê±°
  - ë„ë‹¬ ë¶ˆê°€ëŠ¥í•œ ì½”ë“œ ê²€ì‚¬
  - ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜/ë³€ìˆ˜ ì œê±°

##### 1.3.3 ì½”ë“œ ì •ë¦¬

- [ ] **1.3.3.1** Import ì •ë ¬
  ```bash
  isort backend/app/api/parsing.py --check-only --diff
  ```

- [ ] **1.3.3.2** ì½”ë“œ í¬ë§·íŒ…
  ```bash
  black backend/app/api/parsing.py --check
  ```

#### í…ŒìŠ¤íŠ¸

- [ ] **1.3.T1** ëª¨ë“  íŒŒì‹± ì „ëµ í…ŒìŠ¤íŠ¸
- [ ] **1.3.T2** API ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ë³€í™” ì—†ìŒ í™•ì¸
- [ ] **1.3.T3** ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ë‚´ìš© ë™ì¼ í™•ì¸

---

### Phase 1 ì™„ë£Œ ê²€ì¦

#### ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] **P1.F1** ëª¨ë“  íŒŒì‹± ì „ëµ ì •ìƒ ë™ì‘
  - [ ] Remote OCR (í•œê¸€ ë¬¸ì„œ)
  - [ ] MinerU (ì¼ë°˜ PDF)
  - [ ] Docling + Camelot (í…Œì´ë¸” ë¬¸ì„œ)

- [ ] **P1.F2** ì¶œë ¥ íŒŒì¼ êµ¬ì¡° ë™ì¼
  - [ ] `output/{doc_name}/content.md`
  - [ ] `output/{doc_name}/metadata.json`
  - [ ] `output/{doc_name}/tables/*.json`

- [ ] **P1.F3** ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì •ìƒ
  - [ ] Document ë ˆì½”ë“œ
  - [ ] ParsingHistory ë ˆì½”ë“œ
  - [ ] Table ë ˆì½”ë“œ

#### ì½”ë“œ í’ˆì§ˆ

- [ ] **P1.Q1** mypy íƒ€ì… ê²€ì‚¬ í†µê³¼
  ```bash
  mypy backend/app/api/parsing.py --strict
  ```

- [ ] **P1.Q2** flake8 ë¦°í„° í†µê³¼
  ```bash
  flake8 backend/app/api/parsing.py --max-line-length=120
  ```

- [ ] **P1.Q3** í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í™•ì¸
  ```bash
  pytest backend/tests/ --cov=app --cov-report=html
  ```

#### ë¬¸ì„œí™”

- [ ] **P1.D1** CLAUDE.md ì—…ë°ì´íŠ¸ (Phase 1 ì™„ë£Œ ë°˜ì˜)
- [ ] **P1.D2** ë³€ê²½ì‚¬í•­ ë¡œê·¸ ì‘ì„±

#### ìµœì¢… ìŠ¹ì¸

- [ ] **P1.A1** ì½”ë“œ ë¦¬ë·° ì™„ë£Œ
- [ ] **P1.A2** QA í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] **P1.A3** Git tag ìƒì„±: `refactor/phase1-complete`

---

## Phase 2: ì•„í‚¤í…ì²˜ ê°œì„  (2-4ì£¼)

> **ëª©í‘œ**: Strategy Pattern ë„ì…ìœ¼ë¡œ í™•ì¥ì„± í™•ë³´
> **í•µì‹¬ ì „ëµ**: Feature Flagë¡œ ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜
> **ë¦¬ìŠ¤í¬ ë ˆë²¨**: MEDIUM-HIGH (ì•„í‚¤í…ì²˜ ë³€ê²½)
> **ì•ˆì „ì¥ì¹˜**: ê¸°ì¡´ ë¡œì§ ì™„ì „ ë³´ì¡´ + ì–¸ì œë“  ì „í™˜ ê°€ëŠ¥

### ğŸš¨ ì¤‘ìš”: ê¸°ì¡´ ë¡œì§ ë³´ì¡´ ì›ì¹™

Phase 2ì—ì„œëŠ” **ê¸°ì¡´ ë¡œì§ì„ í•œ ê¸€ìë„ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**.

- ìƒˆ íŒŒì¼ë§Œ ì¶”ê°€
- `parsing.py`ì—ëŠ” Feature Flag ë¶„ê¸°ë§Œ ì¶”ê°€
- ê¸°ë³¸ê°’ì€ í•­ìƒ ê¸°ì¡´ ë¡œì§ ì‚¬ìš©
- í™˜ê²½ ë³€ìˆ˜ë¡œ ì–¸ì œë“  ì „í™˜ ê°€ëŠ¥

---

### Task 2.1: ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ë° ë°ì´í„° í´ë˜ìŠ¤ ì •ì˜

**ìƒˆ íŒŒì¼**: `backend/app/services/parsing_strategy.py`

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

##### 2.1.1 íŒŒì¼ ìƒì„± ë° ê¸°ë³¸ êµ¬ì¡°

- [ ] **2.1.1.1** íŒŒì¼ ìƒì„± ë° í•„ìˆ˜ import
  - ABC, abstractmethod
  - dataclass
  - Path, Optional, Dict, Any, List
  - ê¸°ì¡´ ëª¨ë“ˆ: TableParsingOptions, ParsingMetadata, file_utils

##### 2.1.2 ParsingResult ë°ì´í„° í´ë˜ìŠ¤

- [ ] **2.1.2.1** `ParsingResult` í´ë˜ìŠ¤ ì •ì˜
  - í•„ìˆ˜ í•„ë“œ: content, metadata, output_structure, parsing_metadata
  - ì„ íƒ í•„ë“œ: warnings, docling_doc, table_extractions
  - `to_response_dict()` ë©”ì„œë“œ êµ¬í˜„

- [ ] **2.1.2.2** íƒ€ì… íŒíŠ¸ ì™„ë²½í•˜ê²Œ ì‘ì„±

- [ ] **2.1.2.3** Docstring ì‘ì„± (Google ìŠ¤íƒ€ì¼)

##### 2.1.3 ParsingStrategy ì¶”ìƒ ë² ì´ìŠ¤ í´ë˜ìŠ¤

- [ ] **2.1.3.1** `ParsingStrategy` ABC ì •ì˜
  - `__init__(name, logger)` êµ¬í˜„
  - `can_handle(file_path, opts)` ì¶”ìƒ ë©”ì„œë“œ
  - `parse(file_path, opts)` ì¶”ìƒ ë©”ì„œë“œ

- [ ] **2.1.3.2** ê³µí†µ í—¬í¼ ë©”ì„œë“œ êµ¬í˜„
  - `prepare_output_dir()` - ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
  - `save_content()` - ì»¨í…ì¸  ì €ì¥

##### 2.1.4 ì½”ë“œ í’ˆì§ˆ

- [ ] **2.1.4.1** íƒ€ì… íŒíŠ¸ ì™„ë²½í•˜ê²Œ ì‘ì„±
- [ ] **2.1.4.2** Docstring ì‘ì„± (ëª¨ë“  í´ë˜ìŠ¤/ë©”ì„œë“œ)
- [ ] **2.1.4.3** mypy strict mode í†µê³¼

#### í…ŒìŠ¤íŠ¸

- [ ] **2.1.T1** ParsingResult ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
  - ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
  - to_response_dict() í…ŒìŠ¤íŠ¸

- [ ] **2.1.T2** ParsingStrategy ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸
  - Mock êµ¬í˜„ì²´ ì‘ì„±
  - ì¶”ìƒ ë©”ì„œë“œ ê°•ì œ êµ¬í˜„ í™•ì¸

- [ ] **2.1.T3** mypy íƒ€ì… ê²€ì‚¬
  ```bash
  mypy backend/app/services/parsing_strategy.py --strict
  ```

---

### Task 2.2: ê° íŒŒì„œë³„ Strategy í´ë˜ìŠ¤ êµ¬í˜„

#### Sub-task 2.2.1: RemoteOCRStrategy

**íŒŒì¼**: `backend/app/services/parsing_strategy.py` (ê³„ì† ì‘ì„±)

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.2.1.1** `RemoteOCRStrategy` í´ë˜ìŠ¤ ì •ì˜
  - `ParsingStrategy` ìƒì†
  - `__init__()` êµ¬í˜„

- [ ] **2.2.1.2** `can_handle()` êµ¬í˜„
  - `opts.use_remote_ocr and REMOTE_OCR_AVAILABLE` ì²´í¬

- [ ] **2.2.1.3** `parse()` êµ¬í˜„
  - ê¸°ì¡´ `parse_with_remote_ocr()` í˜¸ì¶œ
  - ì¶œë ¥ ë””ë ‰í† ë¦¬ ì¤€ë¹„
  - ë©”íƒ€ë°ì´í„° í‘œì¤€í™”
  - `ParsingResult` ë°˜í™˜

- [ ] **2.2.1.4** ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€
  - ì„œë¹„ìŠ¤ ì—°ê²° ì‹¤íŒ¨ ì²˜ë¦¬
  - ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€

##### í…ŒìŠ¤íŠ¸

- [ ] **2.2.1.T1** `can_handle()` ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
  - REMOTE_OCR_AVAILABLE=True ì¼€ì´ìŠ¤
  - REMOTE_OCR_AVAILABLE=False ì¼€ì´ìŠ¤

- [ ] **2.2.1.T2** `parse()` Mock í…ŒìŠ¤íŠ¸
  - `parse_with_remote_ocr()` Mock
  - ê²°ê³¼ ê²€ì¦

- [ ] **2.2.1.T3** í†µí•© í…ŒìŠ¤íŠ¸ (ê¸°ì¡´ ë¡œì§ê³¼ ê²°ê³¼ ë¹„êµ)
  - A/B í…ŒìŠ¤íŠ¸: ë™ì¼í•œ íŒŒì¼ë¡œ ì–‘ìª½ ë¹„êµ
  - content ë™ì¼ì„± í™•ì¸
  - metadata ë™ì¼ì„± í™•ì¸

#### Sub-task 2.2.2: MinerUStrategy

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.2.2.1** `MinerUStrategy` í´ë˜ìŠ¤ ì •ì˜
- [ ] **2.2.2.2** `can_handle()` êµ¬í˜„
  - PDF íŒŒì¼ ì²´í¬
  - `opts.use_mineru and MINERU_AVAILABLE` ì²´í¬
- [ ] **2.2.2.3** `parse()` êµ¬í˜„
  - ê¸°ì¡´ `parse_with_mineru()` í˜¸ì¶œ
  - ë©”íƒ€ë°ì´í„° ë³€í™˜
  - `ParsingResult` ë°˜í™˜
- [ ] **2.2.2.4** ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€

##### í…ŒìŠ¤íŠ¸

- [ ] **2.2.2.T1** ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] **2.2.2.T2** Mock í…ŒìŠ¤íŠ¸
- [ ] **2.2.2.T3** í†µí•© í…ŒìŠ¤íŠ¸ (A/B ë¹„êµ)

#### Sub-task 2.2.3: DoclingStrategy (ê°€ì¥ ë³µì¡)

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.2.3.1** `DoclingStrategy` í´ë˜ìŠ¤ ì •ì˜
- [ ] **2.2.3.2** `can_handle()` êµ¬í˜„
  - Fallback ì „ëµì´ë¯€ë¡œ í•­ìƒ True
- [ ] **2.2.3.3** `parse()` êµ¬í˜„ - ì£¼ìš” ë¡œì§
  - Docling íŒŒì‹±
  - Camelot í†µí•© (ì˜µì…˜)
  - í…Œì´ë¸” ì¶”ì¶œ (ì˜µì…˜)
  - Picture ë¶„ì„ (ì˜µì…˜)
- [ ] **2.2.3.4** ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€

##### í…ŒìŠ¤íŠ¸

- [ ] **2.2.3.T1** ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] **2.2.3.T2** Docling only í…ŒìŠ¤íŠ¸
- [ ] **2.2.3.T3** Docling + Camelot í…ŒìŠ¤íŠ¸
- [ ] **2.2.3.T4** í†µí•© í…ŒìŠ¤íŠ¸ (A/B ë¹„êµ)

---

### Task 2.3: Strategy Selector ë° Feature Flag

#### Sub-task 2.3.1: Strategy Selector

**íŒŒì¼**: `backend/app/services/parsing_strategy.py` (ê³„ì†)

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.3.1.1** `select_parsing_strategy()` í•¨ìˆ˜ êµ¬í˜„
  - ìš°ì„ ìˆœìœ„: Remote OCR â†’ MinerU â†’ Docling
  - ê° ì „ëµì˜ `can_handle()` ì²´í¬
  - ì„ íƒëœ ì „ëµ ë¡œê¹…
  - ì „ëµ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜

- [ ] **2.3.1.2** ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€
  - ì‚¬ìš© ê°€ëŠ¥í•œ ì „ëµì´ ì—†ì„ ê²½ìš°
  - ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€

- [ ] **2.3.1.3** ë¡œê¹… ì¶”ê°€
  - ì„ íƒëœ ì „ëµ ì •ë³´
  - ì‚¬ìš© ê°€ëŠ¥í•œ ì „ëµ ëª©ë¡

##### í…ŒìŠ¤íŠ¸

- [ ] **2.3.1.T1** ì „ëµ ì„ íƒ ìš°ì„ ìˆœìœ„ í…ŒìŠ¤íŠ¸
  - Remote OCR ìš°ì„  í…ŒìŠ¤íŠ¸
  - MinerU ìš°ì„  í…ŒìŠ¤íŠ¸
  - Docling fallback í…ŒìŠ¤íŠ¸

- [ ] **2.3.1.T2** ëª¨ë“  ì „ëµ ë¶ˆê°€ëŠ¥ ì‹œ ì—ëŸ¬ í…ŒìŠ¤íŠ¸

#### Sub-task 2.3.2: Feature Flag ì‹œìŠ¤í…œ

**ìƒˆ íŒŒì¼**: `backend/app/config/feature_flags.py`

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.3.2.1** `FeatureFlags` ì‹±ê¸€í†¤ í´ë˜ìŠ¤ ìƒì„±
  - `USE_STRATEGY_PATTERN` í”Œë˜ê·¸ (ê¸°ë³¸ê°’: False)
  - í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
  - `reload()` ë©”ì„œë“œ (í…ŒìŠ¤íŠ¸ìš©)

- [ ] **2.3.2.2** í™˜ê²½ ë³€ìˆ˜ ì´ë¦„ ì •ì˜
  - `FEATURE_USE_STRATEGY_PATTERN`
  - ê¸°ë³¸ê°’: "false"

##### í…ŒìŠ¤íŠ¸

- [ ] **2.3.2.T1** Feature Flag ê¸°ë³¸ê°’ í…ŒìŠ¤íŠ¸
- [ ] **2.3.2.T2** í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í…ŒìŠ¤íŠ¸
- [ ] **2.3.2.T3** reload() í…ŒìŠ¤íŠ¸

#### Sub-task 2.3.3: parsing.pyì— Feature Flag í†µí•©

**íŒŒì¼**: `backend/app/api/parsing.py`

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **2.3.3.1** import ì¶”ê°€
  - `from app.config.feature_flags import feature_flags`
  - `from app.services.parsing_strategy import select_parsing_strategy`

- [ ] **2.3.3.2** `parse_document()` í•¨ìˆ˜ ì‹œì‘ ë¶€ë¶„ì— ë¶„ê¸° ì¶”ê°€
  - Feature Flag ì²´í¬
  - Trueì´ë©´ `parse_with_strategy()` í˜¸ì¶œ
  - Falseì´ë©´ ê¸°ì¡´ ë¡œì§ (í•œ ê¸€ìë„ ìˆ˜ì • ì•ˆ í•¨)

- [ ] **2.3.3.3** `parse_with_strategy()` í•¨ìˆ˜ êµ¬í˜„ (ìƒˆ í•¨ìˆ˜)
  - íŒŒì¼ ì¡´ì¬ í™•ì¸
  - DB ë ˆì½”ë“œ ìƒì„±
  - ì „ëµ ì„ íƒ
  - íŒŒì‹± ì‹¤í–‰
  - í†µê³„ ê³„ì‚°
  - DB ì €ì¥
  - ì‘ë‹µ ë°˜í™˜

- [ ] **2.3.3.4** ê¸°ì¡´ ë¡œì§ ì™„ì „ ë³´ì¡´ í™•ì¸
  - ê¸°ì¡´ ì½”ë“œ í•œ ê¸€ìë„ ìˆ˜ì • ì•ˆ í•¨
  - ë“¤ì—¬ì“°ê¸° ë³€ê²½ ì—†ìŒ

##### ì•ˆì „ì¥ì¹˜

- [ ] **2.3.3.S1** ê¸°ë³¸ê°’ì€ False (ê¸°ì¡´ ë¡œì§)
- [ ] **2.3.3.S2** í™˜ê²½ ë³€ìˆ˜ë¡œ ì „í™˜ ê°€ëŠ¥í•˜ë„ë¡
- [ ] **2.3.3.S3** ì—ëŸ¬ ë°œìƒ ì‹œ ëª…í™•í•œ ë¡œê·¸
- [ ] **2.3.3.S4** ëª¨ë‹ˆí„°ë§ ë¡œê·¸ ì¶”ê°€

##### í…ŒìŠ¤íŠ¸

- [ ] **2.3.3.T1** Feature Flag OFF: ê¸°ì¡´ ë¡œì§ ë™ì‘
  ```bash
  FEATURE_USE_STRATEGY_PATTERN=false pytest backend/tests/integration/
  ```

- [ ] **2.3.3.T2** Feature Flag ON: ìƒˆ ë¡œì§ ë™ì‘
  ```bash
  FEATURE_USE_STRATEGY_PATTERN=true pytest backend/tests/integration/
  ```

- [ ] **2.3.3.T3** A/B í…ŒìŠ¤íŠ¸: ê²°ê³¼ 100% ë™ì¼
  - content ë¹„êµ
  - metadata ë¹„êµ
  - output_structure ë¹„êµ
  - íŒŒì¼ ì¶œë ¥ ë¹„êµ

- [ ] **2.3.3.T4** ì„±ëŠ¥ ë¹„êµ (ë²¤ì¹˜ë§ˆí¬)
  - 10MB PDF íŒŒì‹± ì‹œê°„ ì¸¡ì •
  - ì°¨ì´ 5% ì´ë‚´ í™•ì¸

---

### Task 2.4: ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™”

**ìƒˆ íŒŒì¼**: `backend/app/utils/error_handling.py`

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

##### 2.4.1 ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤

- [ ] **2.4.1.1** `ParsingError` ë² ì´ìŠ¤ í´ë˜ìŠ¤
  - message, parser_name, can_fallback í•„ë“œ

- [ ] **2.4.1.2** `ServiceUnavailableError`
  - ì„œë¹„ìŠ¤ ì—°ê²° ë¶ˆê°€ ì—ëŸ¬
  - service_url, reason í•„ë“œ

- [ ] **2.4.1.3** `ParserNotInstalledError`
  - íŒŒì„œ ë¯¸ì„¤ì¹˜ ì—ëŸ¬
  - install_command í•„ë“œ

- [ ] **2.4.1.4** `InvalidFileFormatError`
  - ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹
  - supported_formats í•„ë“œ

##### 2.4.2 ì—ëŸ¬ ë©”ì‹œì§€ í‘œì¤€í™”

- [ ] **2.4.2.1** ì—ëŸ¬ ë©”ì‹œì§€ í…œí”Œë¦¿ ì •ì˜
- [ ] **2.4.2.2** ë‹¤êµ­ì–´ ì§€ì› ê³ ë ¤ (ì„ íƒì‚¬í•­)

#### í…ŒìŠ¤íŠ¸

- [ ] **2.4.T1** ê° ì˜ˆì™¸ í´ë˜ìŠ¤ í…ŒìŠ¤íŠ¸
- [ ] **2.4.T2** ì—ëŸ¬ ë©”ì‹œì§€ í˜•ì‹ í™•ì¸

---

### Task 2.5: ì„¤ì • ê´€ë¦¬ ì¤‘ì•™í™”

**ìƒˆ íŒŒì¼**: `backend/app/config/parsing_config.py`

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

##### 2.5.1 Config í´ë˜ìŠ¤ ì •ì˜

- [ ] **2.5.1.1** `DolphinConfig` ë°ì´í„° í´ë˜ìŠ¤
  - server_url, health_timeout, inference_timeout, image_target_size

- [ ] **2.5.1.2** `OCRConfig` ë°ì´í„° í´ë˜ìŠ¤
  - remote_server_url, pdf_render_dpi, default_languages

- [ ] **2.5.1.3** `ParsingConstants` ë°ì´í„° í´ë˜ìŠ¤
  - BYTES_PER_KB, DEFAULT_TABLE_COMPLEXITY_THRESHOLD, etc.

- [ ] **2.5.1.4** `ParsingConfig` í†µí•© í´ë˜ìŠ¤
  - dolphin, ocr, constants í•„ë“œ
  - Singleton íŒ¨í„´

##### 2.5.2 ìƒˆ Strategy í´ë˜ìŠ¤ì— ì ìš©

- [ ] **2.5.2.1** Strategy í´ë˜ìŠ¤ë“¤ì´ config ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •
- [ ] **2.5.2.2** í•˜ë“œì½”ë”©ëœ ê°’ ì œê±°

#### í…ŒìŠ¤íŠ¸

- [ ] **2.5.T1** Config í´ë˜ìŠ¤ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] **2.5.T2** í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ í…ŒìŠ¤íŠ¸
- [ ] **2.5.T3** ê¸°ë³¸ê°’ í™•ì¸

---

### Phase 2 ì™„ë£Œ ê²€ì¦

#### ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (Feature Flag OFF)

- [ ] **P2.F1** ëª¨ë“  íŒŒì‹± ì „ëµ ì •ìƒ ë™ì‘ (ê¸°ì¡´ ë¡œì§)
  - [ ] Remote OCR
  - [ ] MinerU
  - [ ] Docling + Camelot

- [ ] **P2.F2** API ì‘ë‹µ ë™ì¼
- [ ] **P2.F3** ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ë™ì¼

#### ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (Feature Flag ON)

- [ ] **P2.F4** ëª¨ë“  íŒŒì‹± ì „ëµ ì •ìƒ ë™ì‘ (ìƒˆ ë¡œì§)
  - [ ] RemoteOCRStrategy
  - [ ] MinerUStrategy
  - [ ] DoclingStrategy

- [ ] **P2.F5** API ì‘ë‹µ ê¸°ì¡´ê³¼ 100% ë™ì¼
- [ ] **P2.F6** ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ë™ì¼

#### A/B í…ŒìŠ¤íŠ¸

- [ ] **P2.AB1** ê°™ì€ ë¬¸ì„œë¡œ ì–‘ìª½ í…ŒìŠ¤íŠ¸
  - [ ] content ë™ì¼
  - [ ] metadata ë™ì¼
  - [ ] output_structure ë™ì¼
  - [ ] íŒŒì¼ ì¶œë ¥ ë™ì¼

#### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] **P2.P1** ì„±ëŠ¥ ì°¨ì´ 5% ì´ë‚´
  - [ ] 10MB PDF í…ŒìŠ¤íŠ¸
  - [ ] 100 í˜ì´ì§€ PDF í…ŒìŠ¤íŠ¸
  - [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¸¡ì •

#### ì½”ë“œ í’ˆì§ˆ

- [ ] **P2.Q1** mypy íƒ€ì… ê²€ì‚¬ í†µê³¼ (strict mode)
  ```bash
  mypy backend/app/services/parsing_strategy.py --strict
  ```

- [ ] **P2.Q2** í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 85% ì´ìƒ
  ```bash
  pytest --cov=app.services.parsing_strategy --cov-report=html
  ```

- [ ] **P2.Q3** ë¦°í„° í†µê³¼
  ```bash
  flake8 backend/app/services/parsing_strategy.py
  ```

#### ë¬¸ì„œí™”

- [ ] **P2.D1** CLAUDE.md ì—…ë°ì´íŠ¸ (Strategy Pattern ì„¹ì…˜ ì¶”ê°€)
- [ ] **P2.D2** Feature Flag ì‚¬ìš©ë²• ë¬¸ì„œí™”
- [ ] **P2.D3** ìƒˆ íŒŒì„œ ì¶”ê°€ ê°€ì´ë“œ ì‘ì„±

#### ëª¨ë‹ˆí„°ë§ (1-2ì£¼)

- [ ] **P2.M1** Feature Flag ONìœ¼ë¡œ 1ì£¼ ëª¨ë‹ˆí„°ë§
  - [ ] ì—ëŸ¬ ë¡œê·¸ í™•ì¸
  - [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
  - [ ] ì‚¬ìš©ì í”¼ë“œë°±

- [ ] **P2.M2** ì´ìŠˆ ì—†ìŒ í™•ì¸

#### ìµœì¢… ìŠ¹ì¸

- [ ] **P2.A1** ì½”ë“œ ë¦¬ë·° ì™„ë£Œ
- [ ] **P2.A2** QA í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] **P2.A3** íŒ€ ë¦¬ë” ìŠ¹ì¸
- [ ] **P2.A4** Git tag ìƒì„±: `refactor/phase2-complete`

---

## Phase 3: ìµœì í™” ë° ì •ë¦¬ (4-6ì£¼)

> **ëª©í‘œ**: êµ¬ ë¡œì§ ì œê±° ë° ìµœì¢… ìµœì í™”
> **ì „ì œ ì¡°ê±´**: Phase 2 ì™„ë£Œ + 1-2ì£¼ í”„ë¡œë•ì…˜ ê²€ì¦
> **ë¦¬ìŠ¤í¬ ë ˆë²¨**: MEDIUM (êµ¬ ë¡œì§ ì‚­ì œ)

### âš ï¸ Phase 3 ì‹œì‘ ì¡°ê±´

ë‹¤ìŒ ì¡°ê±´ì„ **ëª¨ë‘** ë§Œì¡±í•  ë•Œë§Œ ì‹œì‘:

1. Phase 2 ì™„ë£Œ
2. Feature Flag ONìœ¼ë¡œ 1-2ì£¼ í”„ë¡œë•ì…˜ ìš´ì˜
3. ì´ìŠˆ 0ê±´ (ë˜ëŠ” ëª¨ë‘ í•´ê²°ë¨)
4. ì„±ëŠ¥/ì•ˆì •ì„± ê²€ì¦ ì™„ë£Œ
5. íŒ€ ë¦¬ë” ìŠ¹ì¸

---

### Task 3.1: Feature Flag ê¸°ë³¸ê°’ ë³€ê²½

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.1.1** `feature_flags.py` ê¸°ë³¸ê°’ ë³€ê²½
  - `USE_STRATEGY_PATTERN` ê¸°ë³¸ê°’: "true"

- [ ] **3.1.2** 1ì£¼ ëª¨ë‹ˆí„°ë§
  - [ ] ì—ëŸ¬ ë¡œê·¸ í™•ì¸
  - [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
  - [ ] ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘

- [ ] **3.1.3** ì´ìŠˆ ì—†ìœ¼ë©´ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰

---

### Task 3.2: êµ¬ ë¡œì§ ì œê±°

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.2.1** `parsing.py` ë°±ì—…
  ```bash
  cp backend/app/api/parsing.py backend/app/api/parsing.py.backup
  git add backend/app/api/parsing.py.backup
  git commit -m "backup: parsing.py before Phase 3"
  ```

- [ ] **3.2.2** Feature Flag ë¶„ê¸° ì œê±°
  - Feature Flag ì²´í¬ ì œê±°
  - `parse_with_strategy()` í•¨ìˆ˜ë§Œ ì‚¬ìš©

- [ ] **3.2.3** ê¸°ì¡´ if-elif ì²´ì¸ ì œê±°
  - 500 ë¼ì¸ ì½”ë“œ ì‚­ì œ
  - parse_with_strategy()ë¡œ ë‹¨ìˆœí™”

- [ ] **3.2.4** Feature Flag ì‹œìŠ¤í…œ ì œê±° (ì„ íƒì‚¬í•­)
  - `feature_flags.py` ì‚­ì œ ë˜ëŠ” ìœ ì§€

- [ ] **3.2.5** í…ŒìŠ¤íŠ¸
  - [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
  - [ ] ìˆ˜ë™ í…ŒìŠ¤íŠ¸

#### ë¡¤ë°± ì ˆì°¨

- [ ] **3.2.R1** ë°±ì—…ì—ì„œ ë³µì›
  ```bash
  cp backend/app/api/parsing.py.backup backend/app/api/parsing.py
  git commit -m "rollback: restore old parsing logic"
  ```

---

### Task 3.3: ì„¤ì • ê´€ë¦¬ ì ìš© (ê¸°ì¡´ íŒŒì¼)

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.3.1** `dolphin_remote.py` ìˆ˜ì •
  - í™˜ê²½ ë³€ìˆ˜ ì§ì ‘ ë¡œë“œ â†’ config ì‚¬ìš©

- [ ] **3.3.2** `remote_ocr_parser.py` ìˆ˜ì •
  - í™˜ê²½ ë³€ìˆ˜ ì§ì ‘ ë¡œë“œ â†’ config ì‚¬ìš©

- [ ] **3.3.3** `docling.py` ìˆ˜ì •
  - í™˜ê²½ ë³€ìˆ˜ ì§ì ‘ ë¡œë“œ â†’ config ì‚¬ìš©

- [ ] **3.3.4** í…ŒìŠ¤íŠ¸
  - [ ] ëª¨ë“  ì„œë¹„ìŠ¤ ì •ìƒ ë™ì‘
  - [ ] ì„¤ì • ê°’ ë¡œë“œ í™•ì¸

---

### Task 3.4: ì„±ëŠ¥ ìµœì í™”

#### Sub-task 3.4.1: ë¶ˆí•„ìš”í•œ íƒ€ì… ë³€í™˜ ì œê±°

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.4.1.1** `table_utils.py` ìµœì í™”
  - ë¶ˆí•„ìš”í•œ `str()` ë³€í™˜ ì œê±°
  - DataFrame iteration ìµœì í™”

##### ë²¤ì¹˜ë§ˆí¬

- [ ] **3.4.1.B1** ìµœì í™” ì „ ì„±ëŠ¥ ì¸¡ì •
- [ ] **3.4.1.B2** ìµœì í™” í›„ ì„±ëŠ¥ ì¸¡ì •
- [ ] **3.4.1.B3** ê°œì„ ìœ¨ ê¸°ë¡

#### Sub-task 3.4.2: íŒŒì¼ I/O ìµœì í™”

##### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.4.2.1** ì¤‘ë³µ íŒŒì¼ ì“°ê¸° ì œê±°
- [ ] **3.4.2.2** ë°°ì¹˜ ì €ì¥ ì ìš© (ê°€ëŠ¥í•œ ê²½ìš°)

##### ë²¤ì¹˜ë§ˆí¬

- [ ] **3.4.2.B1** ìµœì í™” ì „/í›„ ë¹„êµ
- [ ] **3.4.2.B2** I/O ì‹œê°„ ê°œì„ ìœ¨ ê¸°ë¡

---

### Task 3.5: í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í™•ëŒ€

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.5.1** ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 90% ì´ìƒ
  ```bash
  pytest backend/tests/ --cov=app --cov-report=html --cov-report=term
  ```

- [ ] **3.5.2** í†µí•© í…ŒìŠ¤íŠ¸ ì¶”ê°€
  - [ ] E2E ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±
  - [ ] ì—¬ëŸ¬ íŒŒì¼ í˜•ì‹ í…ŒìŠ¤íŠ¸ (PDF, DOCX, PPTX, HTML)
  - [ ] ëŒ€ìš©ëŸ‰ íŒŒì¼ í…ŒìŠ¤íŠ¸ (10MB+, 100í˜ì´ì§€+)

- [ ] **3.5.3** ì„±ëŠ¥ íšŒê·€ í…ŒìŠ¤íŠ¸ ìë™í™”
  - [ ] ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸ ì‘ì„±
  - [ ] CI/CD íŒŒì´í”„ë¼ì¸ì— í†µí•©

- [ ] **3.5.4** Edge case í…ŒìŠ¤íŠ¸
  - [ ] ë¹ˆ íŒŒì¼
  - [ ] ì†ìƒëœ íŒŒì¼
  - [ ] ë§¤ìš° í° íŒŒì¼
  - [ ] íŠ¹ìˆ˜ ë¬¸ì í¬í•¨ íŒŒì¼ëª…

---

### Task 3.6: ì½”ë“œ ì •ë¦¬ ë° í¬ë§·íŒ…

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.6.1** ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” import ì œê±°
  ```bash
  autoflake --remove-all-unused-imports --recursive --in-place backend/app/
  ```

- [ ] **3.6.2** Import ì •ë ¬
  ```bash
  isort backend/app/
  ```

- [ ] **3.6.3** ì½”ë“œ í¬ë§·íŒ…
  ```bash
  black backend/app/
  ```

- [ ] **3.6.4** ë¦°í„° ì‹¤í–‰
  ```bash
  flake8 backend/app/ --max-line-length=120
  pylint backend/app/ --rcfile=.pylintrc
  ```

- [ ] **3.6.5** íƒ€ì… ì²´ì»¤
  ```bash
  mypy backend/app/ --strict
  ```

- [ ] **3.6.6** ë³´ì•ˆ ê²€ì‚¬ (ì„ íƒì‚¬í•­)
  ```bash
  bandit -r backend/app/
  ```

---

### Task 3.7: ë¬¸ì„œí™”

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] **3.7.1** CLAUDE.md ìµœì¢… ì—…ë°ì´íŠ¸
  - [ ] Strategy Pattern ì•„í‚¤í…ì²˜ ì„¤ëª…
  - [ ] ìƒˆ íŒŒì„œ ì¶”ê°€ ê°€ì´ë“œ
  - [ ] ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ (ì„ íƒì‚¬í•­)

- [ ] **3.7.2** API ë¬¸ì„œ ì—…ë°ì´íŠ¸
  - [ ] ë³€ê²½ì‚¬í•­ ì—†ìŒ í™•ì¸
  - [ ] ì˜ˆì œ ì—…ë°ì´íŠ¸

- [ ] **3.7.3** ê°œë°œì ê°€ì´ë“œ ì‘ì„±
  - [ ] ìƒˆ íŒŒì„œ ì¶”ê°€ ë°©ë²•
  - [ ] í…ŒìŠ¤íŠ¸ ì‘ì„± ë°©ë²•
  - [ ] ë””ë²„ê¹… ê°€ì´ë“œ

- [ ] **3.7.4** ë³€ê²½ì‚¬í•­ ë¡œê·¸ (CHANGELOG.md)
  - [ ] Phase 1-3 ë³€ê²½ì‚¬í•­ ìš”ì•½
  - [ ] Breaking changes ì—†ìŒ í™•ì¸
  - [ ] ì„±ëŠ¥ ê°œì„  ë‚´ì—­

- [ ] **3.7.5** ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ì‘ì„± (ì„ íƒì‚¬í•­)
  - [ ] Before/After ë¹„êµ
  - [ ] Strategy Pattern êµ¬ì¡°ë„

---

### Phase 3 ì™„ë£Œ ê²€ì¦

#### ìµœì¢… ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] **P3.F1** ëª¨ë“  íŒŒì‹± ì „ëµ ì •ìƒ ë™ì‘
  - [ ] Remote OCR
  - [ ] MinerU
  - [ ] Docling + Camelot

- [ ] **P3.F2** API í•˜ìœ„ í˜¸í™˜ì„± 100%
  - [ ] Request ìŠ¤í‚¤ë§ˆ ë™ì¼
  - [ ] Response ìŠ¤í‚¤ë§ˆ ë™ì¼

- [ ] **P3.F3** ë°ì´í„°ë² ì´ìŠ¤ í˜¸í™˜ì„± 100%
  - [ ] ê¸°ì¡´ ë°ì´í„° ì½ê¸° ê°€ëŠ¥
  - [ ] ìƒˆ ë°ì´í„° ì €ì¥ í˜•ì‹ ë™ì¼

#### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] **P3.P1** ì„±ëŠ¥ ì €í•˜ ì—†ìŒ (ë˜ëŠ” ê°œì„ )
  - [ ] 10MB PDF: _____ â†’ _____ ì´ˆ
  - [ ] 100í˜ì´ì§€ PDF: _____ â†’ _____ ì´ˆ

- [ ] **P3.P2** ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
  - [ ] ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì—†ìŒ

- [ ] **P3.P3** ë™ì‹œì„± í…ŒìŠ¤íŠ¸
  - [ ] 10ê°œ ë™ì‹œ ìš”ì²­ ì²˜ë¦¬

#### ì½”ë“œ í’ˆì§ˆ

- [ ] **P3.Q1** í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 90% ì´ìƒ
  - í˜„ì¬: _____ %

- [ ] **P3.Q2** ëª¨ë“  ë¦°í„° í†µê³¼
  - [ ] flake8
  - [ ] pylint
  - [ ] mypy --strict

- [ ] **P3.Q3** ì½”ë“œ ë³µì¡ë„ ê°ì†Œ
  - [ ] ìˆœí™˜ ë³µì¡ë„ â‰¤5
  - [ ] í•¨ìˆ˜ ë¼ì¸ ìˆ˜ â‰¤100

#### ë¬¸ì„œí™”

- [ ] **P3.D1** ëª¨ë“  ë¬¸ì„œ ì—…ë°ì´íŠ¸ ì™„ë£Œ
  - [ ] CLAUDE.md
  - [ ] README.md
  - [ ] CHANGELOG.md
  - [ ] ê°œë°œì ê°€ì´ë“œ

- [ ] **P3.D2** API ë¬¸ì„œ ìµœì‹ í™”

#### ìµœì¢… ìŠ¹ì¸

- [ ] **P3.A1** ìµœì¢… ì½”ë“œ ë¦¬ë·°
- [ ] **P3.A2** QA í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] **P3.A3** íŒ€ ë¦¬ë” ìŠ¹ì¸
- [ ] **P3.A4** Git tag ìƒì„±: `refactor/complete`
- [ ] **P3.A5** ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ ì‘ì„±

---

## ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê° Phaseë§ˆë‹¤ ìˆ˜í–‰

#### ê¸°ëŠ¥ ê²€ì¦

- [ ] **V.F1** ëª¨ë“  íŒŒì‹± ì „ëµ ë™ì‘ í™•ì¸
  - [ ] Remote OCR (í•œê¸€ ë¬¸ì„œ)
  - [ ] MinerU (ì¼ë°˜ PDF)
  - [ ] Docling + Camelot (í…Œì´ë¸” ë¬¸ì„œ)

- [ ] **V.F2** API ì—”ë“œí¬ì¸íŠ¸ í˜¸í™˜ì„±
  - [ ] `/parse` request ìŠ¤í‚¤ë§ˆ ë™ì¼
  - [ ] `/parse` response ìŠ¤í‚¤ë§ˆ ë™ì¼
  - [ ] `/parse/async` ì •ìƒ ë™ì‘
  - [ ] `/parse/status/{job_id}` ì •ìƒ ë™ì‘

- [ ] **V.F3** ë°ì´í„°ë² ì´ìŠ¤ í˜¸í™˜ì„±
  - [ ] Document í…Œì´ë¸” ì €ì¥
  - [ ] ParsingHistory í…Œì´ë¸” ì €ì¥
  - [ ] Table í…Œì´ë¸” ì €ì¥
  - [ ] ê¸°ì¡´ ë°ì´í„° ì½ê¸° ê°€ëŠ¥

- [ ] **V.F4** íŒŒì¼ ì¶œë ¥ í™•ì¸
  - [ ] `output/{doc_name}/content.md` ìƒì„±
  - [ ] `output/{doc_name}/metadata.json` ìƒì„±
  - [ ] `output/{doc_name}/tables/*.json` ìƒì„±
  - [ ] íŒŒì¼ ë‚´ìš© ë³€í™” ì—†ìŒ

#### ì„±ëŠ¥ ê²€ì¦

- [ ] **V.P1** ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸
  - [ ] 10MB PDF íŒŒì‹± ì‹œê°„: _____ ì´ˆ
  - [ ] 100í˜ì´ì§€ PDF íŒŒì‹± ì‹œê°„: _____ ì´ˆ
  - [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: _____ MB
  - [ ] ë¦¬íŒ©í† ë§ ì „/í›„ ë¹„êµ (ì°¨ì´ 5% ì´ë‚´)

#### ì½”ë“œ í’ˆì§ˆ ê²€ì¦

- [ ] **V.Q1** ë¦°í„° í†µê³¼
  ```bash
  flake8 backend/app/ --max-line-length=120
  pylint backend/app/ --rcfile=.pylintrc
  ```

- [ ] **V.Q2** íƒ€ì… ì²´ì»¤ í†µê³¼
  ```bash
  mypy backend/app/ --strict
  ```

- [ ] **V.Q3** í¬ë§·í„° ì ìš©
  ```bash
  black --check backend/app/
  isort --check-only backend/app/
  ```

- [ ] **V.Q4** í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì¸¡ì •
  ```bash
  pytest --cov=app --cov-report=html --cov-report=term
  ```
  - í˜„ì¬ ì»¤ë²„ë¦¬ì§€: _____ %

---

## ë¡¤ë°± ì „ëµ

### Phase 1 ë¡¤ë°±

#### ì ˆì°¨

1. **Git revertë¡œ ì»¤ë°‹ ë˜ëŒë¦¬ê¸°**
   ```bash
   git log --oneline  # ì»¤ë°‹ í•´ì‹œ í™•ì¸
   git revert <commit-hash>
   ```

2. **í…ŒìŠ¤íŠ¸ ì‹¤í–‰ìœ¼ë¡œ ê¸°ì¡´ ë™ì‘ í™•ì¸**
   ```bash
   pytest backend/tests/
   ```

3. **ì´ìŠˆ ë¶„ì„ ë° ìˆ˜ì • ê³„íš ìˆ˜ë¦½**

4. **ìˆ˜ì • í›„ ì¬ì‹œë„**

---

### Phase 2 ë¡¤ë°±

#### ì ˆì°¨ (Feature Flag í™œìš©)

1. **Feature Flagë¥¼ Falseë¡œ ì„¤ì •**
   ```bash
   # .env íŒŒì¼ ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜
   FEATURE_USE_STRATEGY_PATTERN=false
   ```

2. **ì„œë¹„ìŠ¤ ì¬ì‹œì‘**
   ```bash
   # ì¦‰ì‹œ ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ ì „í™˜ë¨
   ```

3. **ì •ìƒ ë™ì‘ í™•ì¸**
   ```bash
   curl http://localhost:8000/health
   ```

4. **ì´ìŠˆ ë¡œê·¸ ìˆ˜ì§‘ ë° ë¶„ì„**

5. **ì˜¤í”„ë¼ì¸ì—ì„œ ìˆ˜ì • ë° ì¬í…ŒìŠ¤íŠ¸**

6. **ìˆ˜ì • ì™„ë£Œ í›„ ë‹¤ì‹œ Flag Trueë¡œ ì „í™˜**

---

### Phase 3 ë¡¤ë°±

#### ì ˆì°¨ (ë°±ì—… í™œìš©)

1. **ë°±ì—… íŒŒì¼ì—ì„œ ë³µì›**
   ```bash
   cp backend/app/api/parsing.py.backup backend/app/api/parsing.py
   git commit -m "rollback: restore old parsing logic"
   ```

2. **í…ŒìŠ¤íŠ¸ ì‹¤í–‰**

3. **ì„œë¹„ìŠ¤ ì¬ì‹œì‘**

4. **ì•ˆì •í™” í›„ Phase 3 ì¬ì‹œë„**

---

## ì„±ê³µ ì§€í‘œ

### ì •ëŸ‰ì  ì§€í‘œ

- [ ] **M.Q1** ì½”ë“œ ë¼ì¸ ìˆ˜ 25% ê°ì†Œ
  - Before: 2,656 lines
  - Target: ~2,000 lines
  - Actual: _______ lines

- [ ] **M.Q2** parse_document() í•¨ìˆ˜ 80% ê°ì†Œ
  - Before: 502 lines
  - Target: ~100 lines
  - Actual: _______ lines

- [ ] **M.Q3** ì¤‘ë³µ ì½”ë“œ 100% ì œê±°
  - Before: 20+ ê³³
  - Target: 0 ê³³
  - Actual: _______ ê³³

- [ ] **M.Q4** ìˆœí™˜ ë³µì¡ë„ 67% ê°ì†Œ
  - Before: 15+
  - Target: â‰¤5
  - Actual: _______

- [ ] **M.Q5** í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 90% ì´ìƒ
  - Before: _______ %
  - Target: â‰¥90%
  - Actual: _______ %

- [ ] **M.Q6** ì„±ëŠ¥ ì €í•˜ ì—†ìŒ
  - Target: ì°¨ì´ â‰¤5%
  - Actual: _______ %

### ì •ì„±ì  ì§€í‘œ

- [ ] **M.QL1** ìƒˆ íŒŒì„œ ì¶”ê°€ ì‹œê°„ 50% ë‹¨ì¶•
  - Before: ~4ì‹œê°„
  - After: ~2ì‹œê°„

- [ ] **M.QL2** ë²„ê·¸ ë°œìƒë¥  ê°ì†Œ
  - íƒ€ì… ì•ˆì •ì„±ìœ¼ë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ ê°ì†Œ

- [ ] **M.QL3** ì½”ë“œ ë¦¬ë·° ì‹œê°„ ë‹¨ì¶•
  - ëª…í™•í•œ êµ¬ì¡°ë¡œ ë¦¬ë·° ìš©ì´

- [ ] **M.QL4** ì‹ ê·œ ê°œë°œì ì˜¨ë³´ë”© ì‹œê°„ ë‹¨ì¶•
  - ì˜ êµ¬ì¡°í™”ëœ ì½”ë“œë¡œ í•™ìŠµ ê³¡ì„  ì™„í™”

---

## íƒ€ì„ë¼ì¸

```
Week 1-2   : Phase 1 (ê¸´ê¸‰ ê°œì„ ) - ì§„í–‰ ì¤‘
             â”œâ”€ Task 1.1: locals() ì œê±° âœ…
             â”œâ”€ Task 1.2: ì¤‘ë³µ ì½”ë“œ ì¶”ì¶œ âœ…
             â””â”€ Task 1.3: ë³€ìˆ˜ëª… ê°œì„  ë° ì •ë¦¬ ğŸ”„

Week 3-6   : Phase 2 (ì•„í‚¤í…ì²˜ ê°œì„ )
             â”œâ”€ Task 2.1: ì¸í„°í˜ì´ìŠ¤ ì •ì˜
             â”œâ”€ Task 2.2: Strategy êµ¬í˜„
             â”œâ”€ Task 2.3: Feature Flag
             â”œâ”€ Task 2.4: ì—ëŸ¬ ì²˜ë¦¬
             â””â”€ Task 2.5: ì„¤ì • ê´€ë¦¬

Week 7-8   : Phase 2 ê²€ì¦ (ëª¨ë‹ˆí„°ë§)

Week 9-14  : Phase 3 (ìµœì í™” ë° ì •ë¦¬)
             â”œâ”€ Task 3.1: Flag ê¸°ë³¸ê°’ ë³€ê²½
             â”œâ”€ Task 3.2: êµ¬ ë¡œì§ ì œê±°
             â”œâ”€ Task 3.3: ì„¤ì • ì ìš©
             â”œâ”€ Task 3.4: ì„±ëŠ¥ ìµœì í™”
             â”œâ”€ Task 3.5: í…ŒìŠ¤íŠ¸ í™•ëŒ€
             â”œâ”€ Task 3.6: ì½”ë“œ ì •ë¦¬
             â””â”€ Task 3.7: ë¬¸ì„œí™”

Week 15    : ìµœì¢… ê²€ì¦ ë° ë¦´ë¦¬ìŠ¤
```

---

## ë¦¬íŒ©í† ë§ í›„ íŒŒì¼ êµ¬ì¡°

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ parsing.py (ìˆ˜ì •: Feature Flag + parse_with_strategy)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ parsing_strategy.py (ì‹ ê·œ: Strategy Pattern)
â”‚   â”‚   â”œâ”€â”€ docling.py (ìˆ˜ì • ìµœì†Œ)
â”‚   â”‚   â”œâ”€â”€ dolphin_remote.py (ìˆ˜ì •: config ì‚¬ìš©)
â”‚   â”‚   â”œâ”€â”€ remote_ocr_parser.py (ìˆ˜ì •: config ì‚¬ìš©)
â”‚   â”‚   â””â”€â”€ mineru_parser.py (ìˆ˜ì • ì—†ìŒ)
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ file_utils.py (ì‹ ê·œ: íŒŒì¼ í—¬í¼) âœ…
â”‚   â”‚   â”œâ”€â”€ error_handling.py (ì‹ ê·œ: ì—ëŸ¬ ì²˜ë¦¬)
â”‚   â”‚   â”œâ”€â”€ logging_utils.py (ê¸°ì¡´)
â”‚   â”‚   â””â”€â”€ parsing_db.py (ê¸°ì¡´)
â”‚   â”‚
â”‚   â””â”€â”€ config/
â”‚       â”œâ”€â”€ feature_flags.py (ì‹ ê·œ: Feature Flag)
â”‚       â””â”€â”€ parsing_config.py (ì‹ ê·œ: ì„¤ì • ê´€ë¦¬)
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ test_file_utils.py (ì‹ ê·œ)
    â”œâ”€â”€ test_parsing_strategy.py (ì‹ ê·œ)
    â”œâ”€â”€ test_error_handling.py (ì‹ ê·œ)
    â””â”€â”€ integration/
        â””â”€â”€ test_parsing_scenarios.py (ì‹ ê·œ)
```

---

## ì°¸ê³  ë¬¸ì„œ

- [CLAUDE.md](../CLAUDE.md) - í”„ë¡œì íŠ¸ ì „ì²´ ë¬¸ì„œ
- [Backend README](../backend/README.md) - ë°±ì—”ë“œ êµ¬ì„± ë° ì‹¤í–‰ ë°©ë²•

---

**ë¦¬íŒ©í† ë§ ì›ì¹™**:

1. **ì•ˆì „ì„± ìš°ì„ **: Feature Flagë¥¼ í†µí•´ ì–¸ì œë“  ë¡¤ë°± ê°€ëŠ¥
2. **ì ì§„ì  ê°œì„ **: 3ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ ë‹¨ê³„ë³„ ê²€ì¦
3. **í•˜ìœ„ í˜¸í™˜ì„±**: API/DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì—†ìŒ
4. **í…ŒìŠ¤íŠ¸ ì£¼ë„**: ê° ë‹¨ê³„ë§ˆë‹¤ ì² ì €í•œ í…ŒìŠ¤íŠ¸
5. **ë¬¸ì„œí™”**: ëª¨ë“  ë³€ê²½ì‚¬í•­ ë¬¸ì„œí™”

---

**ì‘ì„±ì ë…¸íŠ¸**:

ì´ í”Œëœì€ Sequential Thinking MCPë¥¼ í™œìš©í•œ ì²´ê³„ì  ë¶„ì„ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ê° PhaseëŠ” ë…ë¦½ì ìœ¼ë¡œ ë¡¤ë°± ê°€ëŠ¥í•˜ë©°, Feature Flagë¥¼ í†µí•´ ì•ˆì „í•˜ê²Œ ë§ˆì´ê·¸ë ˆì´ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
